# 数据校验规则
# 定义联系人文档的数据校验

version: "1.0"

# 必填字段
required:
  - name

# 字段校验规则
fields:
  name:
    type: string
    min_length: 1
    max_length: 100
    message: "姓名不能为空，且长度不超过100个字符"
    
  mobile:
    type: string
    pattern: "^1[3-9]\\d{9}$"
    message: "请输入有效的手机号码"
    
  email:
    type: string
    pattern: "^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$"
    message: "请输入有效的邮箱地址"
    
  birthday:
    type: date
    max: "{{today}}"
    message: "生日不能晚于今天"
    
  postal_code:
    type: string
    pattern: "^\\d{6}$"
    message: "请输入6位数字邮政编码"

# 联合校验规则
rules:
  # 至少需要一种联系方式
  - name: "at_least_one_contact"
    condition: "mobile || email || wechat || phone"
    message: "请至少填写一种联系方式"
    level: "warning"

# 自动填充规则
auto_fill:
  created_at:
    value: "{{now}}"
    on: "create"
  updated_at:
    value: "{{now}}"
    on: "update"

